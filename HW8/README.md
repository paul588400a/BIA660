# CNN

## Assignment 8

## Usage

python zhuang21.py

## Entry point

./zhuang21.py

## Notice

what you need to include in the same directory is as following:

./amazon_review_large.csv

## Output would be as follows:

Train on 14000 samples, validate on 6000 samples
Epoch 1/20
Epoch 00001: val_acc improved from -inf to 0.83183, saving model to best_model
 - 99s - loss: 0.9225 - acc: 0.6933 - val_loss: 0.4175 - val_acc: 0.8318
Epoch 2/20
Epoch 00002: val_acc improved from 0.83183 to 0.84683, saving model to best_model
 - 93s - loss: 0.3664 - acc: 0.8566 - val_loss: 0.3732 - val_acc: 0.8468
Epoch 3/20
Epoch 00003: val_acc did not improve
 - 96s - loss: 0.2580 - acc: 0.9106 - val_loss: 0.3957 - val_acc: 0.8417
Epoch 00003: early stopping
acc: 90.95%
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
main_input (InputLayer)         (None, 200)          0                                            
__________________________________________________________________________________________________
embedding (Embedding)           (None, 200, 200)     1000200     main_input[0][0]                 
__________________________________________________________________________________________________
conv_2 (Conv1D)                 (None, 199, 64)      25664       embedding[0][0]                  
__________________________________________________________________________________________________
conv_3 (Conv1D)                 (None, 198, 64)      38464       embedding[0][0]                  
__________________________________________________________________________________________________
conv_4 (Conv1D)                 (None, 197, 64)      51264       embedding[0][0]                  
__________________________________________________________________________________________________
max_2 (MaxPooling1D)            (None, 1, 64)        0           conv_2[0][0]                     
__________________________________________________________________________________________________
max_3 (MaxPooling1D)            (None, 1, 64)        0           conv_3[0][0]                     
__________________________________________________________________________________________________
max_4 (MaxPooling1D)            (None, 1, 64)        0           conv_4[0][0]                     
__________________________________________________________________________________________________
flat_2 (Flatten)                (None, 64)           0           max_2[0][0]                      
__________________________________________________________________________________________________
flat_3 (Flatten)                (None, 64)           0           max_3[0][0]                      
__________________________________________________________________________________________________
flat_4 (Flatten)                (None, 64)           0           max_4[0][0]                      
__________________________________________________________________________________________________
concate (Concatenate)           (None, 192)          0           flat_2[0][0]                     
                                                                 flat_3[0][0]                     
                                                                 flat_4[0][0]                     
__________________________________________________________________________________________________
dropout (Dropout)               (None, 192)          0           concate[0][0]                    
__________________________________________________________________________________________________
dense (Dense)                   (None, 192)          37056       dropout[0][0]                    
__________________________________________________________________________________________________
output (Dense)                  (None, 1)            193         dense[0][0]                      
==================================================================================================
Total params: 1,152,841
Trainable params: 1,152,841
Non-trainable params: 0
__________________________________________________________________________________________________
None
             precision    recall  f1-score   support

          0       0.91      0.90      0.90      2850
          1       0.91      0.91      0.91      3150

avg / total       0.91      0.91      0.91      6000

total_nb_words:
47008
Out[12]:
word	count
0	this	28881
1	sound	901
2	track	372
Out[12]:
index	count
0	1	23170
1	2	6305
2	3	3117
Out[12]:
index	count	percent	cumsum
0	1	23170	0.492895	0.492895
1	2	6305	0.134126	0.627021
2	3	3117	0.066308	0.693329
3	4	2062	0.043865	0.737194
4	5	1403	0.029846	0.767040
Out[12]:
<Container object of 50 artists>
Out[12]:
[<matplotlib.lines.Line2D at 0x12f9b1690>]
Out[12]:
<matplotlib.text.Text at 0x12d592390>
Out[12]:
<matplotlib.text.Text at 0x12d59d590>

Out[12]:
index	counts
186	2	1
182	3	1
177	5	4
Out[12]:
index	counts	percent	cumsum
186	2	1	0.00005	0.00005
182	3	1	0.00005	0.00010
177	5	4	0.00020	0.00030
Out[12]:
[<matplotlib.lines.Line2D at 0x12db8dcd0>]
Out[12]:
<matplotlib.text.Text at 0x12af8fa90>
Out[12]:
<matplotlib.text.Text at 0x12afb5550>







